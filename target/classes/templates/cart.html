<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <!-- th:replace="base::layout(~{::section})" -->

  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
     <script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

<script src="https://code.angularjs.org/1.8.0/angular-route.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>

<!-- Google Font -->
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<link
	href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap"
	rel="stylesheet">

<!-- Css Styles -->
<link rel="stylesheet" href="/user/css/bootstrap.min.css"
	type="text/css">
<link rel="stylesheet" href="/user/css/font-awesome.min.css"
	type="text/css">
<link rel="stylesheet" href="/user/css/elegant-icons.css"
	type="text/css">
<link rel="stylesheet" href="/user/css/nice-select.css" type="text/css">
<link rel="stylesheet" href="/user/css/jquery-ui.min.css"
	type="text/css">
<link rel="stylesheet" href="/user/css/owl.carousel.min.css"
	type="text/css">
<link rel="stylesheet" href="/user/css/slicknav.min.css" type="text/css">
<link rel="stylesheet" href="/user/css/style.css" type="text/css">

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="/user/css/bootstrap.min.css">




<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

<meta name="viewport" content="width=device-width, initial-scale=1.0">


<link rel="stylesheet"
	href="https://use.fontawesome.com/releases/v5.7.0/css/all.css">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js"
	type="text/javascript"></script>
<link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css"
	rel="stylesheet" type="text/css" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../static/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../static/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <title>Hello, world!</title>
    <style>
      .card-registration .select-input.form-control[readonly]:not([disabled]) {
        font-size: 1rem;
        line-height: 2.15;
        padding-left: 0.75em;
        padding-right: 0.75em;
      }

      .card-registration .select-arrow {
        top: 13px;
      }

      .bg-grey {
        background-color: #eae8e8;
      }
    </style>
  </head>
  <body>
    <!--Main Navigation-->
    <header>
      <!-- Jumbotron -->
      <div class="p-3 text-center bg-white border-bottom">
        <div class="container">
          <div class="row gy-3">
            <!-- Left elements -->
            <div class="col-lg-2 col-sm-4 col-4">
              <a
                href="https://mdbootstrap.com/"
                target="_blank"
                class="float-start"
              >
                <img
                  src="https://mdbootstrap.com/img/logo/mdb-transaprent-noshadows.png"
                  height="35"
                />
              </a>
            </div>
            <!-- Left elements -->

            <!-- Center elements -->
            <div class="order-lg-last col-lg-5 col-sm-8 col-8">
              <div class="d-flex float-end">
                <a
                  href="https://github.com/mdbootstrap/bootstrap-material-design"
                  class="me-1 border rounded py-1 px-3 nav-link d-flex align-items-center"
                  target="_blank"
                >
                  <i class="fas fa-user-alt m-1 me-md-2"></i>
                  <li th:if="${session.user == null}">
                    <a th:href="@{/login}">Login</a>
                  </li>
                  <li th:if="${session.user == null}">
                    <a th:href="@{/register}">Register</a>
                  </li>
                  <p class="d-none d-md-block mb-0">Sign in</p>
                </a>
                <a
                  href="https://github.com/mdbootstrap/bootstrap-material-design"
                  class="me-1 border rounded py-1 px-3 nav-link d-flex align-items-center"
                  target="_blank"
                >
                  <i class="fas fa-heart m-1 me-md-2"></i>
                  <p class="d-none d-md-block mb-0">Wishlist</p>
                </a>
                <a
                  href="https://github.com/mdbootstrap/bootstrap-material-design"
                  class="border rounded py-1 px-3 nav-link d-flex align-items-center"
                  target="_blank"
                >
                  <i class="fas fa-shopping-cart m-1 me-md-2"></i>
                  <p class="d-none d-md-block mb-0">My cart</p>
                </a>
              </div>
            </div>
            <!-- Center elements -->

            <!-- Right elements -->
            <div class="col-lg-5 col-md-12 col-12">
              <form class="input-group float-center" th:action="@{search}">
                <div class="form-outline">
                  <input
                    type="search"
                    id="form1"
                    class="form-control"
                    name="keywords"
                    placeholder="Search..."
                  />
                </div>
                <button type="submit" class="btn btn-primary shadow-0">
                  <i class="fas fa-search"></i>
                </button>
              </form>
            </div>
            <!-- Right elements -->
          </div>
        </div>
      </div>
      <!-- Jumbotron -->

      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-light bg-white">
        <!-- Container wrapper -->
        <div
          class="container justify-content-center justify-content-md-between"
        >
          <!-- Toggle button -->
          <button
            class="navbar-toggler border py-2 text-dark"
            type="button"
            data-mdb-toggle="collapse"
            data-mdb-target="#navbarLeftAlignExample"
            aria-controls="navbarLeftAlignExample"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <i class="fas fa-bars"></i>
          </button>

          <!-- Collapsible wrapper -->
          <div class="collapse navbar-collapse" id="navbarLeftAlignExample">
            <!-- Left links -->
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link text-dark" aria-current="page" href="#"
                  >Home</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">Categories</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">Hot offers</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">Gift boxes</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">Projects</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">Menu item</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-dark" href="#">Menu name</a>
              </li>
              <!-- Navbar dropdown -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle text-dark"
                  href="#"
                  id="navbarDropdown"
                  role="button"
                  data-mdb-toggle="dropdown"
                  aria-expanded="false"
                >
                  Others
                </a>
                <!-- Dropdown menu -->
                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <li>
                    <a class="dropdown-item" href="#">Action</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#">Another action</a>
                  </li>
                  <li><hr class="dropdown-divider" /></li>
                  <li>
                    <a class="dropdown-item" href="#">Something else here</a>
                  </li>
                </ul>
              </li>
            </ul>
            <!-- Left links -->
          </div>
        </div>
        <!-- Container wrapper -->
      </nav>
      <!-- Navbar -->
      <!-- Jumbotron -->
      <div class="bg-primary text-white py-5">
        <div class="container py-5">
          <h1>
            Best products & <br />
            brands in our store
          </h1>
          <p>Trendy Products, Factory Prices, Excellent Service</p>
          <button type="button" class="btn btn-outline-light">
            Learn more
          </button>
          <button
            type="button"
            class="btn btn-light shadow-0 text-primary pt-2 border border-white"
          >
            <span class="pt-1">Purchase now</span>
          </button>
        </div>
      </div>
      <!-- Jumbotron -->
    </header>
    <!-- Filter -->
    <div class="container my-5">
      <div class="row flex-row">
        <button class="btn btn-success" th:each="productType : ${productTypes}">
          <a
            th:href="@{|/filter?sort=${productType.description}|}"
            class="list-group-item list-group-item-action"
            th:text="${productType.description}"
          ></a>
        </button>
      </div>
    </div>
    <!-- Filter -->
    <!-- <div th:replace="${content}"></div> -->
    <!-- Footer -->
    <footer
      class="text-center text-lg-start text-muted mt-3"
      style="background-color: #f5f5f5"
    >
      <!-- Section: Links  -->
      <section   class="h-100 h-custom" style="background-color: #d2c9ff">
        <div class="container py-5 h-100">
          <div
            class="row d-flex justify-content-center align-items-center h-100"
          >
            <div class="col-12">
              <div
                class="card card-registration card-registration-2"
                style="border-radius: 15px"
              >
                <div class="card-body p-0">
                  <div class="row g-0">
                    <div class="col-lg-8">
                      <div class="p-5" id="viewCartFragment">
                        <div
                          class="d-flex justify-content-between align-items-center mb-5"
                        >
                          <h1 class="fw-bold mb-0 text-black">Shopping Cart</h1>
                          <h6 class="mb-0 text-muted">3 items</h6>
                        </div>

                        <hr class="my-4" />

                        <div th:each="detail, i : ${session.currentCart.details}"
                          class="row mb-4 d-flex justify-content-between align-items-center"
                        
                        >
                          <div class="col-md-2 col-lg-2 col-xl-2">
                            <img
                              th:src="@{|img/${detail.value.imgUrl}|}"
                              class="img-fluid rounded-3"
                              alt="Cotton T-shirt"
                            />
                          </div>
                          <div class="col-md-3 col-lg-3 col-xl-3">
                            <h6
                              class="text-black mb-0"
                              th:text="${detail.value.name}"
                            ></h6>
                          </div>
                          <div class="col-md-3 col-lg-3 col-xl-2 d-flex">
                            <button
                              class="btn btn-link px-2"
                              onclick="this.parentNode.querySelector('input[type=number]').stepDown()"
                            >
                              <i class="fas fa-minus"></i>
                            </button>

                            <input
                              type="number"
                              class="input-text qty text"
                              title="Qty"
                              min="1"
                              value="1"
                              th:value="${detail.value.quantity}"
                              th:id="quantity + ${detail.key}"
                              th:attr="onchange='updateQuantity(\'' + ${detail.key} + '\')'"
                            />

                            <button
                              class="btn btn-link px-2"
                              onclick="this.parentNode.querySelector('input[type=number]').stepUp()"
                            >
                              <i class="fas fa-plus"></i>
                            </button>
                          </div>
                          <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1">
                            <h6
                              class="mb-0 amount"
                              th:text="${#numbers.formatCurrency(detail.value.price)}"
                            ></h6>
                          </div>
                          <div class="col-md-1 col-lg-1 col-xl-1 text-end">
                            <a
                              href="#!"
                              class="text-muted remove"
                              th:attr="onclick='removeProduct(\'' + ${detail.key} + '\')'"
                              ><i class="fas fa-times"></i
                            ></a>
                          </div>
                        </div>

                        <hr class="my-4" />

                        <div class="pt-5">
                          <h6 class="mb-0">
                            <a href="#!" class="text-body"
                              ><i class="fas fa-long-arrow-alt-left me-2"></i
                              >Back to shop</a
                            >
                          </h6>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-4 bg-grey">
                      <div class="p-5">
                        <h3 class="fw-bold mb-5 mt-2 pt-1">Summary</h3>
                        <hr class="my-4" />

                        <div class="d-flex justify-content-between mb-4">
                          <h5 class="text-uppercase">items 3</h5>
                        </div>

                        <h5 class="text-uppercase mb-3">Shipping</h5>

                        <div class="mb-4 pb-2">
                          <select class="select">
                            <option value="1">Standard-Delivery- €5.00</option>
                            <option value="2">Two</option>
                            <option value="3">Three</option>
                            <option value="4">Four</option>
                          </select>
                        </div>

                        <h5 class="text-uppercase mb-3">phone</h5>
                        <div class="mb-5">
                          <div class="form-outline">
                            <input
                              type="text" value="" placeholder="Phone number"
                              id="phone_number"
                              class="form-control "
                            />
      
                          </div>
                        </div>
                        <h5 class="text-uppercase mb-3">address</h5>
                         <div class="mb-5">
                          <div class="form-outline">
                            <input
                              type="text" value="" placeholder="Address" 
                             id="address"
                              class="form-control "
                            />
      
                          </div>
                        </div>

                        <hr class="my-4" />

                        <div class="d-flex justify-content-between mb-5">
                          <h5 class="text-uppercase">Total price</h5>
                          <h5 id="headerTotalPrice" th:text="${#numbers.formatCurrency(session.currentCart.totalPrice)}">€ 137.00</h5>
                        </div>

                        <button
                          type="button"
                          th:attr="onclick='checkout()'"
                          class="btn btn-dark btn-block btn-lg"
                          data-mdb-ripple-color="dark"
                        >
                          Register
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- Section: Links  -->

      <div class="">
        <div class="container">
          <div class="d-flex justify-content-between py-4 border-top">
            <!--- payment --->
            <div>
              <i class="fab fa-lg fa-cc-visa text-dark"></i>
              <i class="fab fa-lg fa-cc-amex text-dark"></i>
              <i class="fab fa-lg fa-cc-mastercard text-dark"></i>
              <i class="fab fa-lg fa-cc-paypal text-dark"></i>
            </div>
            <!--- payment --->

            <!--- language selector --->
            <div class="dropdown dropup">
              <a
                class="dropdown-toggle text-dark"
                href="#"
                id="Dropdown"
                role="button"
                data-mdb-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="flag-united-kingdom flag m-0 me-1"></i>English
              </a>

              <ul
                class="dropdown-menu dropdown-menu-end"
                aria-labelledby="Dropdown"
              >
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-united-kingdom flag"></i>English
                    <i class="fa fa-check text-success ms-2"></i
                  ></a>
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-poland flag"></i>Polski</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-china flag"></i>中文</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-japan flag"></i>日本語</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-germany flag"></i>Deutsch</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-france flag"></i>Français</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-spain flag"></i>Español</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-russia flag"></i>Русский</a
                  >
                </li>
                <li>
                  <a class="dropdown-item" href="#"
                    ><i class="flag-portugal flag"></i>Português</a
                  >
                </li>
              </ul>
            </div>
            <!--- language selector --->
          </div>
        </div>
      </div>
    </footer>
    <!-- Footer -->
    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
   
    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->
    <script>
      function removeProduct(productId) {
        var url =
          "/cart/update?productId=" + productId + "&quantity=0&isReplace=true";
        $.get(url).done(function (data) {
          $("#viewCartFragment").replaceWith(data);
          callApiRefreshCart();
        });
      }

      function updateQuantity(productId) {
        var idInput = "#quantity" + productId;
        var newQuantity = $(idInput).val();
        var url =
          "/cart/update?productId=" +
          productId +
          "&quantity=" +
          newQuantity +
          "&isReplace=true";
        $.get(url).done(function (data) {
          $("#viewCartFragment").replaceWith(data);
          callApiRefreshCart();
        });
      }

      function callApiRefreshCart() {
        var url = "/api/cart/refresh";
        $.ajax({
          url: url,
          type: "GET",
          dataType: "json",
          success: function (data) {
            $("#headerTotalPrice").text(formatCurrency(data.totalPrice));
            $("#headerTotalQuantity").text(data.totalQuantity);
          },
          error: function (error) {
            alert(error);
          },
        });
      }

      function checkout() {
        var address = $("#address").val();
        var phone = $("#phone_number").val();
        var url = "/api/cart/checkout?address=" + address + "&phone=" + phone;
        $.ajax({
          url: url,
          type: "GET",
          statusCode: {
            200: handle200,
            400: handle400,
            401: handle401,
          },
        });
      }

      function handle200() {
        alert("Your payment was created successfully");
        window.location.href = "/index";
      }

      function handle400() {
        alert("Checkout failed, please try again");
      }

      function handle401() {
        alert("Please login before paying");
        window.location.href = "/login";
      }

      function formatCurrency(x) {
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + " ₫";
      }
    </script>
      <script src="/user/js/jquery.slicknav.js "></script>
    <script src="/user/js/mixitup.min.js "></script>
    <script src="/user/js/owl.carousel.min.js "></script>
    <script src="/user/js/main.js "></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
